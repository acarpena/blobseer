

Monitoring BlobSeer provider setup guide



Dependencies:

The monitoring BlobSeer provider has the following external dependencies:

 1. BlobSeer - release 0.3.1;
 2. ApMon libraries.
 
 
How to install BlobSeer

A tutorial on how to build BlobSeer and to install its dependencies can be found here:
http://blobseer.gforge.inria.fr/doku.php?id=tutorial:main
  


How to install ApMon libraries
  
Download the ApMon source files from the MonALISA website:

http://monalisa.cacr.caltech.edu/download/apmon/ApMon_cpp-2.2.6.tar.gz


Untar the archive and then compile the routines using the following commands:
      
      ./configure --prefix=$HOME/deploy
      make
      make install
   
The library will be installed in $prefix/lib and the ApMon.h include file into the $prefix/include directory.



How to build the Monitoring BlobSeer provider:

Just like BlobSeer, the Monitoring provider is built using CMake.
The configuration file used by CMake is called CMakeLists.txt.

This tutorial assumes the libraries (BlobSeer dependencies - OpenSSL, Boost, Libconfig - and ApMon) are installed in the local home directory:
                ~/deploy

If any of the libraries was manually installed in a different directory, its path has to be specified in the configuration file (CMakeLists.txt).

The following paths can also be set in the configuration file (CMakeLists.txt), if they are different from the default paths:
- EXTERNAL_ROOT -> the root prefix for the BlobSeer dependencies
                -> default value: ~/deploy
- APMON_ROOT -> the root prefix for the ApMon libraries
             -> default value: ~/deploy  
             -> this directory should contain the following directories:
                            - include
                                 - for the header files or a subdirectory apmon that contains the header files
                            - lib
                                 - for the libraries or a subdirectory apmon that contains the libraries
- BLOBSEER_SOURCE_DIR -> the BlobSeer source directory
                      -> default value: ~/blobseer  


The Makefiles can now be generated using the cmake command for unix makefiles:

cmake -G "Unix Makefiles"


Build the project:

make





How to run the Monitoring BlobSeer Provider:


The deployment to the localhost is similar to the one described for the BlobSeer project:

http://blobseer.gforge.inria.fr/doku.php?id=tutorial:deployment

In the same way as for the simple provider, the Monitoring provider needs a configuration file, which will be supplied as a first parameter.
Here's a sample configuration file:

# Version manager configuration
vmanager: {
    # The host name of the version manager
    host = "localhost";
    # The name of the service (tcp port number) to listen to
    service = "2222";
};
 
# Provider manager configuration
pmanager: {
    host = "localhost";
    service = "1111";
};
 
# Provider configuration
provider: {
    service = "1235";
    # Maximal number of pages to accept for storage
    pages = 1048576;
    # Update rate: when reaching this number of updates report to provider manager
    urate = 100;
};
 
# Built in DHT service configuration
sdht: {
    # Maximal number of hash values to accept for storage 
    maxhash = 1073741824;
};
 
# Client side DHT access interface configuration
dht: {
    # The service name of the DHT service (currently tcp port number the provider listens to)
    service = "1234";
    # List of machines running the builtin dht (sdht)
    gateways = (
	"localhost"
    );
    # How many times to try before giving up
    retry = 1;
    # How many seconds to wait for response
    timeout = 10;
    # How big the client's cache for dht entries is
    cachesize = 1048576;
};

# ApMon server configuration
apmon: {
    # The file that defines the settings for ApMon
    monitorConfig = "config/monitor.conf";
   
};

The configuration file contains, in addition to a simple BlobSeer configuration file, the path to the file that describes the settings for ApMon.
A sample configuration file (with the above content, suitable for deployment on localhost) is provided in the config directory (test.cfg), as well as a sample ApMon settings file (monitor.conf).

Before executing the provider, the LD_LIBRARY_PATH environment variable has to be set to point to the needed libraries: Boost, Libconfig, OpenSSL, ApMon. The following command assumes that all the libraries are installed in the "~/deploy" directory.

export LD_LIBRARY_PATH=~/deploy/lib/


The command to run the provider:

cd $MON_PROVIDER_HOME
./provider/provider config/test.cfg














